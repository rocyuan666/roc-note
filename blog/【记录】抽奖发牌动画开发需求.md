活动过期了，觉得挺有意思的，终于可以拿出来分享了，很遗憾线上也过期了地址没有了，不过我会提供部分线上预览地址（仅供交流学习）并非最终产品
需求介绍：此需求是腾讯旗下qq元気泡小程序渠道的，狐妖小红娘、火影忍者（两者页面一样，下面以狐妖小红娘为例）游戏2020年新年活动页面，本人负责前端效果开发，具体需求看图（并非最终版本）：
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824639539-b5893e0c-ab38-489d-89b4-42d5f6b603b9.png#clientId=uaeae220e-2a1b-4&from=paste&id=u1877ded9&originHeight=607&originWidth=780&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=ucb0a080c-b841-460c-8587-6735763254a&title=)
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824639592-dfed0c12-e8ad-491c-84c4-5626516bdbe3.png#clientId=uaeae220e-2a1b-4&from=paste&id=u37d52bfa&originHeight=605&originWidth=713&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u69041477-87a2-4dde-8b61-0c79457795a&title=)
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824640167-7632c26a-807c-458f-ad7c-53085103f5a8.png#clientId=uaeae220e-2a1b-4&from=paste&id=uf7395b53&originHeight=556&originWidth=784&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u4f4f1125-6c4d-4e1b-bb9c-f17e376b4ed&title=)
本篇主要交流以上需求效果，付上整张原型图（没办法只能传小点的，主要看上面交互）：
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824640033-46c3b5ae-5f25-4c5f-885f-20fed576bd9b.png#clientId=uaeae220e-2a1b-4&from=paste&id=u556f04d2&originHeight=791&originWidth=728&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u4c0fc11f-3492-4914-b61a-f226a76e24a&title=)
设计师出稿（并非最终版本）：
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824639938-669f104b-1333-4612-8cf7-654aa6626fb4.png#clientId=uaeae220e-2a1b-4&from=paste&id=ua8acc0a2&originHeight=861&originWidth=696&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u78592464-0c4e-4f7a-b731-602f78552e7&title=)
### 分析需求（只分析抽卡环节）：

- 点击悬浮卡卡牌进入本页面（站外的悬浮卡牌）卡面不展示五彩棒数量。
- 点击参与，进入抽卡环节： ① 6张卡片浮起； ②非抽奖区域灰色蒙层覆盖； ③显示五彩棒数量；④ 卡片显示两秒后自动聚拢堆叠成一张（看到的一张是第一排左边第一张卡牌）；⑤全部翻转至卡牌的背面，⑥1秒后卡牌按照轨迹分发开（此时卡牌是背面的，并且加上发光效果） ⑦发开后上面人物提示选择一张。⑧选中后选中的卡牌发光且只能选择一张 ，其他卡牌光效消失，显示点击收下按钮。

代码主体入口逻辑（将以上逻辑封装成的方法运行起来，）下面展示了各个逻辑实现的方法。
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824641490-e9209e45-caf1-4ccf-9521-e88237f079dc.png#clientId=uaeae220e-2a1b-4&from=paste&id=udefd1439&originHeight=618&originWidth=587&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=uff9671dc-0add-4c16-af58-850dc1b1a9b&title=)
我将 不展示五彩棒数量的模块（页面本身展示的6个卡牌） 与 展示五彩棒数量的模块（抽卡环节的6个卡牌） 分离开了；因为展示在页面的卡牌只是静态的6张卡牌，而抽奖模块的卡牌看似6张实则12张（每张都是正反），两者不同。
**页面中静态卡牌：**
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824642256-c11f1250-5ac4-406a-b1b8-4c75759c507a.png#clientId=uaeae220e-2a1b-4&from=paste&id=uf64cbce3&originHeight=571&originWidth=495&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u078f07d4-9905-4cf3-9d2b-272b7be76c4&title=)
**抽卡环节中的卡牌：**
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824642252-ce04cedd-2d52-4a0b-aedf-0a1e604e23fa.png#clientId=uaeae220e-2a1b-4&from=paste&id=ubf38c99c&originHeight=807&originWidth=579&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=uec783825-a77d-488d-8f28-5ed82d88e79&title=)
然后将 抽卡环节的卡牌 定位到 静态展示的卡牌 位置上，只不过 抽卡环节的卡牌 隐藏了起来 ，这样方便制作卡片浮起动画。
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824642909-b1227a8b-a2f8-4a0a-af5d-71602a691a38.png#clientId=uaeae220e-2a1b-4&from=paste&id=uc891bdd4&originHeight=590&originWidth=930&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u94cbd368-ed1a-4ab4-88fa-3fc352a61ed&title=)
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824643733-a5bea15f-70ef-43ac-91c1-5d1cc15eef73.png#clientId=uaeae220e-2a1b-4&from=paste&id=ube5c6332&originHeight=153&originWidth=248&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u4ea5d2bf-f506-4e3f-9f55-0f740907f1a&title=)
布局准备好了后，开始我们的逻辑
准备下需要用到了卡牌数据，及封装卡片数据打乱方法（因为每次打开展示都是随机的）
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824643906-eb9fc865-1dc7-433b-9399-5a38c2b63105.png#clientId=uaeae220e-2a1b-4&from=paste&id=u7da1443d&originHeight=440&originWidth=553&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u216756d0-ba64-419b-b8b7-88340102e9d&title=)
① 6张卡片显示浮起；
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824644223-fed2f23d-b7cb-4ab0-a11c-6eb1be8fcdf7.png#clientId=uaeae220e-2a1b-4&from=paste&id=uc5336332&originHeight=525&originWidth=652&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=ucf71869d-ace9-4c59-8716-0d098fecd75&title=)
②非抽奖区域灰色蒙层覆盖；
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824645670-dc5527f8-39d2-4277-8c5c-9612b23c086a.png#clientId=uaeae220e-2a1b-4&from=paste&id=uf040abf1&originHeight=538&originWidth=563&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=uea2cd362-bfde-4e1e-9e54-e2cc028bddc&title=)
③显示五彩棒数量；（也就是将数据渲染出来）
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824645380-d7cefd5e-185d-4e84-9f48-d0147fb0d1e1.png#clientId=uaeae220e-2a1b-4&from=paste&id=u4afb90bd&originHeight=357&originWidth=671&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=ua3ecbc12-fe45-4e95-9222-570b495b892&title=)
④ 卡片显示两秒后自动聚拢堆叠成一张（看到的一张是第一排左边第一张卡牌）； 将第一张z-index提高盖住其他5张。
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824645444-84f5750f-ba3e-42e8-80b1-b7fe07f4d489.png#clientId=uaeae220e-2a1b-4&from=paste&id=u87f15958&originHeight=217&originWidth=495&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=uca96fb21-399f-4310-b5a8-041b906f242&title=)
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824645731-9b9622ca-4eee-449b-8736-a7e9b9092fd9.png#clientId=uaeae220e-2a1b-4&from=paste&id=u8fd9df64&originHeight=805&originWidth=460&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=uf1158363-f50c-44c6-b8d3-6ac5db617e7&title=)
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824646098-66123a91-57f8-4c32-aa71-f8e23e8dc074.png#clientId=uaeae220e-2a1b-4&from=paste&id=u60374c48&originHeight=162&originWidth=838&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u12b9f0fc-37e8-49ce-adc3-18bc3e1e43c&title=)
⑤全部翻转至卡牌的背面， 利用了css3动画及翻转
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824646152-069eb651-a32b-4ffd-a1fd-0588b3f21a50.png#clientId=uaeae220e-2a1b-4&from=paste&id=u73492615&originHeight=337&originWidth=572&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u20440e1c-228c-4122-ba85-938f5b7b4a3&title=)
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824646318-bdc05606-0ad9-44e0-87f1-e1f346215bd7.png#clientId=uaeae220e-2a1b-4&from=paste&id=u81a3c194&originHeight=342&originWidth=473&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u10cdb9f3-ad7c-4233-aa7f-5a9ee1d4055&title=)
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824646738-90c10d6f-f8e2-4f63-9693-c9695bce5d5c.png#clientId=uaeae220e-2a1b-4&from=paste&id=udb275491&originHeight=158&originWidth=663&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=uca4c7b22-fa73-47c2-83eb-e437e31fbce&title=)
⑥1秒后卡牌按照轨迹分发开（此时卡牌是背面的，并且加上发光效果，主体逻辑中翻转后加上发光了，散发卡片后发光还在）
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824646872-c3cbc318-8464-47fc-a43c-29a1803ff677.png#clientId=uaeae220e-2a1b-4&from=paste&id=u761b6f94&originHeight=125&originWidth=387&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u4860aa6a-a893-45f4-bed3-caa262fb7cf&title=)
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824647101-5468b41f-595a-479a-8377-ef9ee2db2b1f.png#clientId=uaeae220e-2a1b-4&from=paste&id=uf4e7734f&originHeight=762&originWidth=516&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u5fc1622e-ad9a-4bcf-be4c-96d2ec32f8b&title=)
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824647083-be258080-15bc-43c4-a634-71654cc09247.png#clientId=uaeae220e-2a1b-4&from=paste&id=u44d985f4&originHeight=161&originWidth=819&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u1eefe1c4-54ad-4c39-8195-b067c5eafa2&title=)
⑦发开后上面人物提示选择一张。 （由于人物提示图片不止一处且只是图片不同，封装起来了）
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824647191-b95dce4d-b650-4584-ae8a-ef8c3d0cfa98.png#clientId=uaeae220e-2a1b-4&from=paste&id=uabc76a80&originHeight=307&originWidth=500&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=uedbd9d04-041c-4101-b7c1-53bbc045416&title=)
⑧选中后选中的卡牌发光且只能选择一张，其他卡牌光效消失，显示点击收下按钮。
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824647491-ea239d13-f9d9-40ac-aff7-43465ed23023.png#clientId=uaeae220e-2a1b-4&from=paste&id=u26b57da9&originHeight=165&originWidth=358&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u128f6f0d-d9af-4a46-b755-b7ef1995529&title=)
![](https://cdn.nlark.com/yuque/0/2021/png/2779910/1628824647396-dcceaa60-7027-45a7-a514-7fe143390c22.png#clientId=uaeae220e-2a1b-4&from=paste&id=ua99d5687&originHeight=696&originWidth=544&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u6ffd5bc2-6d50-49bc-b20d-e4cbe608c49&title=)

